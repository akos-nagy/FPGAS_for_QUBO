%\documentclass[reqno,12pt]{amsart}

%%%%%%%%%% todo stuff %%%%%%%%%%

\documentclass[reqno,oneside,12pt]{amsart}  % for todos

\usepackage[textwidth=0.9in]{todonotes}
\reversemarginpar
\setuptodonotes{fancyline,color=blue!40,size=\tiny}
\setlength{\marginparwidth}{0.8in}

%%%%%%%%%% Packages %%%%%%%%%%

\usepackage{amsmath,bbm,verbatim,wasysym,nicefrac}
%mathtools,appendix,soul,ulem,slashed,upgreek
\usepackage[protrusion=true,babel=true]{microtype}
\usepackage[english]{babel}
\usepackage[widespace]{fourier}
\usepackage[backrefs]{amsrefs}
\usepackage[margin=1in]{geometry}
\usepackage[onehalfspacing]{setspace}
\usepackage[pdfusetitle,pagebackref]{hyperref}
\numberwithin{equation}{section}                % must be called before cleveref
\usepackage[nameinlink,noabbrev]{cleveref}
\expandafter\def\csname ver@etex.sty\endcsname{3000/12/31}
\let\globcount\newcount
\usepackage{autonum}                            % must be called after cleveref
\usepackage{tikz}
\usetikzlibrary{quantikz}

%%%%%%%%%% align break fix %%%%%%%%%%

\allowdisplaybreaks[1]

%%%%%%%%%% Left/Right fix %%%%%%%%%%

\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}

\def\({\mathopen{}\left(}
\def\){\right)\mathclose{}}

%%%%%%%%%% eqref fix %%%%%%%%%%

\makeatletter
\renewcommand*{\eqref}[1]{\hyperref[{#1}]{\textup{\tagform@{\ref*{#1}}}}}
\makeatother

%%%%%%%%%% oxford comma fix %%%%%%%%%%

\newcommand{\creflastconjunction}{, and\nobreakspace}

%%%%%%%%%% formula definitions %%%%%%%%%%

\newcommand*{\eqdef}{\mathrel{\vcenter{\baselineskip0.5ex \lineskiplimit0pt\hbox{.}\hbox{.}}}=}
\newcommand*{\defeq}{=\mathrel{\vcenter{\baselineskip0.5ex \lineskiplimit0pt\hbox{.}\hbox{.}}}}

%%%%%%%%%% Theorems/numbering %%%%%%%%%%

\newtheorem*{acknowledgment}{Acknowledgments}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{hypothesis}[theorem]{Hypothesis}
\newtheorem{example}[theorem]{Example}
\crefname{theorem}{Theorem}{Theorems}                 % label for Theorems
\creflabelformat{theorem}{#2{#1}#3}                   % label format for theorem
\crefname{main}{Main Theorem}{Main Theorems}          % label for the Main Theorems
\creflabelformat{main}{#2{#1}#3}                   % label format for main
\crefname{lemma}{Lemma}{Lemmas}                       % label for Lemmas
\creflabelformat{lemma}{#2{#1}#3}                     % label format for lem
\crefname{corollary}{Corollary}{Corollaries}          % label for Corollaries
\creflabelformat{corollary}{#2{#1}#3}                 % label format for cor
\crefname{ineq}{inequality}{inequalities}             % label for inequalities
\creflabelformat{ineq}{#2{\upshape(#1)}#3}               % label format for ineq
\crefname{diag}{diagram}{diagrams}             % label for diagrams
\creflabelformat{diag}{#2{\upshape(#1)}#3}               % label format for diag
\crefname{cond}{condition}{conditions}                % label for conditions
\creflabelformat{cond}{#2{#1}#3}                   % label format for cond
\crefname{table}{Table}{Tables}                       % label for Tables
\creflabelformat{table}{#2{\upshape(#1)}#3}              % label format for Tables
\crefname{hypothesis}{Hypothesis}{Hypotheses}            % label for Hypotheses
\creflabelformat{hypothesis}{#2{#1}#3}                % label format for Hypotheses
\crefname{remark}{Remark}{Remarks}                    % label for Remarks
\creflabelformat{remark}{#2{#1}#3}                    % label format for Remarks
\crefname{definition}{Definition}{Definitions}           % label for Definitions
\creflabelformat{def}{#2{#1}#3}                       % label format for 'def'

%%%%%%%%%% Blackboard %%%%%%%%%%

\def\id{\mathbbm{1}}
\def\cx{\mathbbm{C}}
\def\bG{\mathbbm{G}}
\def\rl{\mathbbm{R}}
\def\N{\mathbbm{N}}
\def\P{\mathbbm{P}}
\def\Z{\mathbbm{Z}}

\def\bH{\mathbb{H}}

%%%%%%%%%% CalligraPhics %%%%%%%%%%

\def\cA{\mathcal{A}}
\def\cB{\mathcal{B}}
\def\cC{\mathcal{C}}
\def\cD{\mathcal{D}}
\def\cE{\mathcal{E}}
\def\cF{\mathcal{F}}
\def\cG{\mathcal{G}}
\def\cH{\mathcal{H}}
\def\cI{\mathcal{I}}
\def\cK{\mathcal{K}}
\def\cL{\mathcal{L}}
\def\cM{\mathcal{M}}
\def\cN{\mathcal{N}}
\def\cO{\mathcal{O}}
\def\cP{\mathcal{P}}
\def\cR{\mathcal{R}}
\def\cS{\mathcal{S}}
\def\cT{\mathcal{T}}
\def\cU{\mathcal{U}}
\def\cV{\mathcal{V}}
\def\cW{\mathcal{W}}
\def\cZ{\mathcal{Z}}

%%%%%%%%%% Romans %%%%%%%%%%

\def\ad{\mathrm{ad}}
\def\Ad{\mathrm{Ad}}
\def\Aut{\mathrm{Aut}}
\def\coker{\mathrm{coker}}
\def\rd{\mathrm{d}}
\def\diag{\mathrm{diag}}
\def\dist{\mathrm{dist}}
\def\Div{\mathrm{Div}}
\def\dom{\mathrm{dom}}
\def\End{\mathrm{End}}
\def\rG{\mathrm{G}}
\def\Hom{\mathrm{Hom}}
\def\Im{\mathrm{Im}}
\def\image{\mathrm{image}}
\def\index{\mathrm{index}}
\def\Isom{\mathrm{Isom}}
\def\Lie{\mathrm{Lie}}
\def\PU{\mathrm{PU}}
\def\QC{\mathrm{QC}}
\def\rk{\mathrm{rk}}
\def\Re{\mathrm{Re}}
\def\Res{\mathrm{Res}}
\def\sign{\mathrm{sign}}
\def\SL{\mathrm{SL}}
\def\SO{\mathrm{SO}}
\def\Sp{\mathrm{Sp}}
\def\Spec{\mathrm{Spec}}
\def\spn{\mathrm{span}}
\def\Spin{\mathrm{Spin}}
\def\Sym{\mathrm{Sym}}
\def\SU{\mathrm{SU}}
\def\supp{\mathrm{supp}}
\def\tr{\mathrm{tr}}

%%%%%%%%%% Other symbols (paper specific) %%%%%%%%%%



%%%%%%%%%% Other formatting %%%%%%%%%%

\title{(Adaptive) Grover Fixed Point Search for QUBO}
\date{\today}
\keywords{Grover Fixed Point Search, Binary Optimization}
%\subjclass[2020]{}

%\author{\'Akos Nagy}
%\address[\'Akos Nagy]{Department of Mathematics, University of California, Santa Barbara}
%\urladdr{\href{https://akosnagy.com/}{akosnagy.com}}
%\email{\href{mailto:contact@akosnagy.com}{contact@akosnagy.com}}

\hypersetup{
   unicode        = true,
   pdffitwindow   = true,
   pdftoolbar     = false,
   pdfmenubar     = false,
   pdfstartview   = {FitH},
   hypertexnames  = true,
   colorlinks     = true,
   linkcolor      = black,
   citecolor      = black,
   filecolor      = black,
   urlcolor       = blue
}

\calclayout
\pagestyle{plain}
\clubpenalty = 10000
\widowpenalty = 10000
\setlength{\footskip}{20pt}

\hyphenation{}

\begin{document}

\begin{abstract}
	\textit{to be completed later...}
\end{abstract}

\maketitle

\section{Introduction}

\textit{to be completed later...}

\smallskip

\subsection*{Organization of the paper:} In \Cref{sec:algo}, \ldots

\begin{comment}
\smallskip

\begin{acknowledgment}
   
\end{acknowledgment}
\end{comment}

\bigskip

\section{Grover Fixed Points Search}
\label{sec:algo}



\noindent\textbf{Input:} A symmetric, integer-valued, $n$-by-$n$ matrix, $Q$ and a constant $c \in \Z$, or, equivalently, a quadratic function on $x \in \{ 0, 1 \}^n$ given by
\begin{equation}
   f (x) \eqdef x^T Q x + c. \label{eq:QUBO}
\end{equation}
(Note that since $x_i^2 = x_i$, we can move linear terms into the diagonal of $Q$.)

\smallskip

\noindent\textbf{Output:} An estimate for the value
\begin{equation}
   M \eqdef \max \( \left\{ \ f (x) \ \middle| \ x \in \{ 0, 1 \}^n \ \right\} \).
\end{equation}

\medskip

\begin{example}[Maximal Graph Cuts]
   Given a simple, undirected graph, $G = \( V, E \)$, let $Q$ be its graph Laplacian, defined as
   \begin{equation}
      Q_{i, j} = \left\{ \begin{array}{ll} \deg \( v_i \), & \mbox{if } i = j, \\ - 1, & \mbox{if } \{ v_i, v_j \} \in E, \\ 0, & \mbox{otherwise,} \end{array} \right.
   \end{equation}
   $b = 0$ and $c = 0$. Then $V = V^+ \coprod V^-$ is a maximal exactly when $\mathrm{MaxCut} (G) = f(x) = M$, where $x \in \{ 0, 1 \}^n$ is defined as $x_i = 1$ if $v_i \in V^+$ and zero otherwise.

   The Edwards--Erd\H{o}s bound yields
   \begin{equation}
      \mathrm{MaxCut} (G) \geqslant B_G \eqdef \left\{ \begin{array}{ll} \frac{2 |V| + |E| - 1}{4}, & \mbox{if (we know that) $G$ is connected,} \\ \frac{|V|}{2} + \sqrt{\tfrac{|V|}{8} + \tfrac{1}{64}} - \frac{1}{8}, & \mbox{otherwise.} \end{array} \right.
   \end{equation}
\end{example}

\bigskip

\section{The oracles:}

An element $x = \( x_1, x_2, \ldots, x_n \) \in \{ 0, 1 \}^n$ is also regarded as a binary number via $x \sim \overline{x_1 x_2 \ldots x_n} \eqdef \sum_i x_i 2^{n - i}$ and as an element of the computational basis via
\begin{equation}
   \ket{x}_n \eqdef \ket{x_1} \ldots \ket{x_{n - 1}} \ket{x_n},
\end{equation}
Given a function as in \cref{eq:QUBO}, let us pick $m \gg \log_2 \( M \)$ (in fact, $m = \left\lceil \log_2 \( \tr \( Q \) \) \right\rceil + 1$ works for our purposes). We use the binary 2â€™s complement convention when digitizing integers and we with that in mind, we construct a oracle on $\( n + m \)$-qubits, $U_f$, so that
\begin{equation}
   U_f \ket{x}_n \ket{y}_m = \ket{x}_n \ket{y - f (x)}_m.
\end{equation}
Note that the $\( n + 1 \)^{\mathrm{th}}$ register of $U_f \ket{x}_n \ket{y}_m$ is $\ket{1}$ exactly when $y < f (x)$.

\medskip

\subsection{Construction of $U_f$:}

Let $\cP \( \theta \)$ be the following $m$-qubit gate
\begin{equation}
   \begin{quantikz}
      \lstick{\ket{y_1}} \qw  &  \gate{P \( 2^{m - 1} \theta \)} & \qw \rstick{$ e^{i \theta y_1 2^{m - 1}} \ket{y_1}$} \\
      \vdots \\
      \lstick{\ket{y_j}} \qw  &  \gate{P \( 2^{m - j} \theta \)} & \qw \rstick{$ e^{i \theta y_j 2^{m - j}} \ket{y_j}$} \\
      \vdots \\
      \lstick{\ket{y_m}} \qw  &  \gate{P \( \theta \)} & \qw \rstick{$ e^{i \theta y_m} \ket{y_m}$}
   \end{quantikz}   
\end{equation}
Thus $\cP \( \theta \) \ket{y}_m = e^{i \theta y} \ket{y}_m$. Note that
\begin{equation}
   \begin{quantikz}
      \lstick{$\ket{y}_m$} \qw  &  \gate{\mathrm{QFT}} &  \gate{\cP \( k \tfrac{2 \pi}{2^m} \)}  & \gate{\mathrm{QFT}^\dagger} & \qw \rstick{$\ket{z + k}_m$}
   \end{quantikz}   
\end{equation}
Thus if $f (x) = \sum_{i, j} Q_{i, j} x_i x_j + c$, then we need to add:
\begin{enumerate}

   \item $- Q_{i, j}$, exactly when $x_i = x_j = 1$. This amounts to the addition of a $\mathrm{QFT}^\dagger \circ \cP \( - Q_{i, j} \tfrac{2 \pi}{2^m} \) \circ \mathrm{QFT}$ gate, controlled by the $i^{\mathrm{th}}$ and $j^{\mathrm{th}}$ register of $\ket{x}_n$,

   \item $- c$, independent of $\ket{x}$. This amounts to the addition of a $\mathrm{QFT}^\dagger \circ \cP \( - c \tfrac{2 \pi}{2^m} \) \circ \mathrm{QFT}$ gate.

\end{enumerate}

However, the following observation further simplifies the circuit. Let $q_i = \sum_{j = 1}^n Q_{i, j}$ and for $i < j$ let $S^{(i, j)}$ be the $n$-by-$n$ matrix defined via
\begin{equation}
   S_{k, l}^{(i, j)} = \left\{ \begin{array}{ll} 1, & \mbox{if } k = l \in \{ i, j \}, \\ - 1, & \mbox{if } k = i, l = j, \mbox{ or } k = j, l = j, \\ 0, & \mbox{otherwise.} \end{array} \right.
\end{equation}
Then $Q$ can be written as
\begin{equation}
   Q = \diag \( q_1, q_2, \ldots, q_n \) + \sum\limits_{i = 1}^{n - 1} \sum\limits_{j = i + 1}^n Q_{i, j} S^{(i, j)}.
\end{equation}

Since $\mathrm{QFT}$ is unitary, only the first one is needed; similarly, only the last $\mathrm{QFT}^\dagger$ is need. Hence $U_f$ is given by:
\begin{equation}
   \begin{quantikz}
      \lstick{$\ket{x}_n$}   & \qw  & \qw                   & \qw & \ctrl{1}                                        & \qw & \ctrl{1} & \qw                 & \qw \rstick{$\ket{x}_n$} \\
      \lstick{$\ket{y}_m$}   & \qw  & \gate{\mathrm{QFT}}   & \qw & \gate{\cP \( - Q_{1, 1} \tfrac{2 \pi}{2^m} \)}  & \qw & \gate{\ldots} & \gate{\mathrm{QFT}^\dagger} & \qw \rstick{$\ket{y - f \( x \)}_m$}
   \end{quantikz}
\end{equation}

\begin{example}
   \label{example:small_graph}
   Let $n = 4$ and $f (x) = 3 x_1^2 + x_2^2 + x_3^2 + x_4^2 - 2 \( x_1 x_2 + x_1 x_3 + x_1 x_4 \)$. This is equivalent to \cref{eq:QUBO}, with
   \begin{equation}
      Q_{1, 2} = Q_{1, 2} = Q_{1, 4} = - 1, \quad b_1 = 3, \quad b_2 = b_3 = b_4 = 1,
   \end{equation}
   and all other coefficient zero. Furthermore, $m = 3$ works.
\end{example}

\begin{remark}
   When $f$ has symmetries, the above picture can be simplified. For example, in the case of MaxCut, we can assume that, say the last vertex is always in the $0$-components, thus that qubit register can be eliminated.
\end{remark}

Note that the adjusted cost, $y - f (x)$, is encoded, which can later be used to implements the unitary operators $\exp \( i \gamma H_f \)$ without Trotterization as follow: let $\gamma \in \rl$ and let us omit the ancilla qubit. Then $\exp \( i \gamma H_f \) \ket{x}_n = e^{i \gamma \( y - f (x) \)} \ket{x}$ can be prepared via a $\cP \( \gamma \tfrac{2 \pi}{2^m} \)$-gate.

\bigskip

\section{Application to Grover fixed point search and state preparation}

Fix $\delta \in \( 0, 1 \)$ and $y$. Let $\lambda \eqdef \tfrac{\left| C_y \right|}{2^n}$, where $C_y \eqdef \left\{ x \in \{ 0, 1 \}^n \middle| f (x) \geqslant y \right\}$. Finally let $l \eqdef \left\lceil \tfrac{\log_2 \( \tfrac{2}{\delta} \)}{2 \sqrt{\lambda}} - \tfrac{1}{2} \right\rceil$. Then, following \cite{yoder_fixed-point_2014}, we can construct a Quantum circuit (using $U_f$ from the previous section), that results in a state $S_l \ket{0}_n \ket{y}_m$ with the following significance: When the first $n$ qubits are measured in the computational basis, then
\begin{equation}
   P \( x \in C_y \) = \sum_{x \in C_y} \left| \bra{x} S_l \ket{0} \right|^2 \geqslant 1 - \delta^2.
\end{equation}

Let us make the following definitions:
\begin{align}
   U_S                     &\eqdef H^{\otimes n} \otimes \id^{\otimes m}, \\
   R_0 \( \alpha \)        &\eqdef \id^{\otimes (n + m)} + \( 1 - e^{i \alpha} \) \ket{0}_n \bra{0}_n \otimes \id^{\otimes (1 + m)}, \\
   R_T \( \beta \)         &\eqdef U_f^\dagger P_{n + 1} \( \beta \) U_f, \\
   G \( \alpha, \beta \)   &\eqdef - U_S R_0 \( \alpha \) U_S^\dagger R_T \( \beta \).
\end{align}
Let $\( \pmb{\alpha}, \pmb{\beta} \) = \( \alpha_1, \beta_1, \cdots, \alpha_l, \beta_l \)$ be given by
\begin{equation}
   \forall j \in \{ 1, \ldots, l \}: \quad \alpha_j \eqdef - \beta_{l - j + 1} = 2 \cot^{- 1} \( \tan \( \tfrac{2 \pi j}{2 l + 1} \) \sqrt{1 - \gamma^2} \),
\end{equation}
where $\gamma \eqdef \( T_{\nicefrac{1}{\( 2 l + 1\)}} \( \delta^{- 1} \) \)^{- 1}$
and let
\begin{equation}
   S_l \( \pmb{\alpha}, \pmb{\beta} \) = G \( \alpha_l, \beta_l \) G \( \alpha_{l - 1}, \beta_{l - 1} \) \cdots G \( \alpha_1, \beta_1 \) U_S. \label{eq:S_l-def}
\end{equation}





   %========================
   \bibliography{references}
   %========================

\end{document}
